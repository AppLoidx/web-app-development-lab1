<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Labwork 1</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="table.css">
    <link href="https://fonts.googleapis.com/css?family=Lobster&display=swap" rel="stylesheet">

    <!--    Font Awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.min.css">


</head>
<body>
    <script src="jquery-3.4.1.js"></script>
    <script>

        const checkArea = function(){
            let yStr = $("#y-value-select").val().replace(",",".");
            let x = Number($("input[name=x_value]:checked").val());
            let y = Number(yStr);
            let r = Number($("#r-value-select").val());

            return (x >= -r / 2 && x <= 0 && y <= r && y >= 0) || (y >= (-x / 2 - r / 2) && y <= 0 && x <= 0) || ((x * x + y * y) <= r * r /4 && x >= 0 && y >= 0);
        };

        const onYInpChange = function(){
            let elemY = $("#y-value-select");

            let dotTarget = $("#target-dot");
               let value = Number(elemY.val().replace(",","."));
               if (value < -3 ||  value > 5 || isNaN(value) || /[\s]+/.test(elemY.val()) || elemY.val()===""){
                   elemY.removeClass().addClass("is-invalid");
                   dotTarget.attr("r", 0);
                   $('#menhera').attr("src","resources/invalid.jpg");

                   return false;
               } else {

                   document.querySelector('#error-log').textContent = " ";
                   elemY.removeClass().addClass("is-valid");

                   let elemR = $("#r-value-select");
                   let calculatedX = 2 * (Number($("input[name=x_value]:checked").val()) * 50 / Number(elemR.val())) + 150;
                   let calculatedY = -(((Number(elemY.val().replace(",",".")) * 50 * 2) / Number(elemR.val())) - 150);

                   dotTarget.attr("r", 3);
                   dotTarget.attr("cy", calculatedY);
                   dotTarget.attr("cx", calculatedX);

                   if (checkArea()){
                       $('#menhera').attr("src","resources/correct.jpg");
                   } else {
                       $('#menhera').attr("src" , "resources/incorrect.jpg");
                   }

                   return true;
               }
           };

           const submit = function(e) {
                e.preventDefault();
                if (!onYInpChange()){
                    document.querySelector('#error-log').textContent = "Значение Y должно быть в диапазоне [-3;5]";
                    return;
                }

                   const formData = new FormData(document.querySelector('#form'));
                   fetch('php/check.php', {
                       method: 'POST',
                       body: formData,
                   })
                       .then(ans => ans.text())
                       .then(table => document.querySelector('#ans').innerHTML=table);
               };



           document.addEventListener('DOMContentLoaded', function(){
               document.querySelector('#submitButton').addEventListener('click', submit);
           });

           const clear = function(e) {
               e.preventDefault();
               fetch('php/clear.php', {
                   method: 'POST',
               })
                   .then(ans => ans.text())
                   .then(table => document.querySelector('#ans').innerHTML=table);

           };

           document.addEventListener('DOMContentLoaded', function(){
               document.querySelector('#clearButton').addEventListener('click', clear);
           });


    </script>

    <div class="wrapper">


    <header class="header">
        <span>Вариант 212013</span>
        <span class="student-name">Arthur Kupriyanov, P3112</span>
    </header>
    <div class="content">

        <div class="svg-container">
            <svg width="300" height="300" class="svg-graph" xmlns="http://www.w3.org/2000/svg">

    <!--            Линии оси-->

                <line class="axis" x1="0" x2="300" y1="150" y2="150" stroke="black"></line>
                <line class="axis" x1="150" x2="150" y1="0" y2="300" stroke="black"></line>
                <polygon points="150,0 144,15 156,15" stroke="black"></polygon>
                <polygon points="300,150 285,156 285,144" stroke="black"></polygon>

                <line class="coor-line" x1="200" x2="200" y1="155" y2="145" stroke="black"></line>
                <line class="coor-line" x1="250" x2="250" y1="155" y2="145" stroke="black"></line>

                <line class="coor-line" x1="50"  x2="50"  y1="155" y2="145" stroke="black"></line>
                <line class="coor-line" x1="100" x2="100" y1="155" y2="145" stroke="black"></line>

                <line class="coor-line" x1="145" x2="155" y1="100" y2="100" stroke="black"></line>
                <line class="coor-line" x1="145" x2="155" y1="50"  y2="50"  stroke="black"></line>

                <line class="coor-line" x1="145" x2="155" y1="200" y2="200" stroke="black"></line>
                <line class="coor-line" x1="145" x2="155" y1="250" y2="250" stroke="black"></line>

                <text class="coor-text" x="195" y="140">R/2</text>
                <text class="coor-text" x="248" y="140">R</text>

                <text class="coor-text" x="40" y="140">-R</text>
                <text class="coor-text" x="90" y="140">-R/2</text>

                <text class="coor-text" x="160" y="105">R/2</text>
                <text class="coor-text" x="160" y="55">R</text>

                <text class="coor-text" x="160" y="205">-R/2</text>
                <text class="coor-text" x="160" y="255">-R</text>

                <!-- first figure-->
                <polygon class="svg-figure rectangle-figure" points="100,150 100,50 150,50, 150,150"
                         fill="blue" fill-opacity="0.3" stroke="blue"></polygon>

                <!-- second figure circle-->
                <path  class="svg-figure circle-figure" d="M 200 150 A 50 50, 90, 0, 0, 150 100 L 150 150 Z"
                      fill="green" fill-opacity="0.3" stroke="green"></path>

                <!-- third figure-->
                <polygon class="svg-figure triangle-figure" points="50,150 150,150 150,200"
                         fill="yellow" fill-opacity="0.3" stroke="yellow"></polygon>

                <circle r="0" cx="150" cy="150" id="target-dot"></circle>

            </svg>
        </div>

        <form class="data-send-form" id="form" oninput="onYInpChange()">
            <div class="form-inputs">

                <label for="y-value-select"><strong>Y: </strong></label>
                <input id="y-value-select" name="y_value" value="" type="text" placeholder="-3 ... 5" />

                <label for="r-value-select" class="form-label" style="margin-left: 2px"><strong>R: </strong></label>
                <select id="r-value-select" name="r_value">
                    <option value="1">1</option>
                    <option>1.5</option>
                    <option>2</option>
                    <option>2.5</option>
                    <option>3</option>
                </select>


            </div>
            <div class="radio-buttons centered" id="x_value_select">
                <p style="margin-top: 7px"><strong>X: </strong></p>
                <p><label for="radio-button-1" class="radio-label">-4 </label><input class="radio-input" id="radio-button-1" name="x_value" type="radio" value="-4"></p>
                <p><label for="radio-button-2" class="radio-label">-3 </label><input class="radio-input" id="radio-button-2" name="x_value" type="radio" value="-3"></p>
                <p><label for="radio-button-3" class="radio-label">-2 </label><input class="radio-input" id="radio-button-3" name="x_value" type="radio" value="-2" checked></p>
                <p><label for="radio-button-4" class="radio-label">-1 </label><input class="radio-input" id="radio-button-4" name="x_value" type="radio" value="-1"></p>
                <p><label for="radio-button-5" class="radio-label">0 </label><input  class="radio-input" id="radio-button-5" name="x_value" type="radio" value="0" ></p>
                <p><label for="radio-button-6" class="radio-label">1 </label><input  class="radio-input" id="radio-button-6" name="x_value" type="radio" value="1" ></p>
                <p><label for="radio-button-7" class="radio-label">2 </label><input  class="radio-input" id="radio-button-7" name="x_value" type="radio" value="2" ></p>
                <p><label for="radio-button-8" class="radio-label">3 </label><input  class="radio-input" id="radio-button-8" name="x_value" type="radio" value="3" ></p>
                <p><label for="radio-button-9" class="radio-label">4 </label><input  class="radio-input" id="radio-button-9" name="x_value" type="radio" value="4" ></p>
            </div>

            <div class="form-buttons">
                <button class="send-button" type="submit" id="submitButton">Отправить</button>
                <button class="clear-button" type="button" id="clearButton">Очистить</button>
            </div>
            <span id="error-log" style="color: red"> </span>
            <div class="img-wrapper" >
                <img src="resources/default.jpg" id="menhera" style="width: 250px; height: 200px" alt=""/>
            </div>

        </form>

        <div class="table-wrapper" style="overflow-x: auto;" id="ans">

            <div class="table" style="">
                <div class="table-header" style="overflow-x: auto">
                    <div class="header__item"><a id="x-table" class="filter__link" href="#">X</a></div>
                    <div class="header__item"><a id="y-table" class="filter__link filter__link--number" href="#">Y</a></div>
                    <div class="header__item"><a id="r-table" class="filter__link filter__link--number" href="#">R</a></div>
                    <div class="header__item"><a id="result-table" class="filter__link filter__link--number" href="#">result</a></div>
                    <div class="header__item"><a id="time-table" class="filter__link filter__link--number" href="#">Time</a></div>
                    <div class="header__item"><a id="cr-time-table" class="filter__link filter__link--number" href="#">Benchmark</a></div>
                </div>
            </div>
        </div>
    </div>

        <footer>
            <div class="centered">
                <span class="student-name-footer">&copy;Arthur Kupriyanov 2019</span>
                <p class="github-icon">
                    <a href="https://github.com/AppLoidx/web-app-development-lab1">
                        <i class="fa fa-github"></i>
                    </a>
                </p>
            </div>

        </footer>
    </div>

    <script src="anime.min.js"></script>

</body>
</html>
